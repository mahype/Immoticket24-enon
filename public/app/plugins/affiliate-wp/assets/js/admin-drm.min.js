"use strict";AffiliateWPEducation.drm=AffiliateWPEducation.drm||function(document,window,$){var app={init:function(){$(app.ready)},ready:function(){$("#wpbody").append('<div id="affwp-drm-modal"></div>'),app.drmModal(),app.handleLicenseFormSubmission()},drmModal:function(){var modal=$.alert({backgroundDismiss:!1,title:affiliatewp_education.drm.title,icon:"fa fa-exclamation-triangle",content:affiliatewp_education.drm.message,boxWidth:app.getDrmModalWidth(),container:"#affwp-drm-modal",useBootstrap:!1,theme:"modern,affiliatewp-education",closeIcon:!1,buttons:!1,animation:"none"});$(window).on("resize",function(){modal.isOpen()&&modal.setBoxWidth(app.getDrmModalWidth())})},getDrmModalWidth:function(){var windowWidth=$(window).width();return windowWidth<=300?"250px":windowWidth<=750?"450px":windowWidth<=1024?"650px":windowWidth>1070?"850px":"650px"},handleLicenseFormSubmission:function(){var showMessage=function(message){var type=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",$modalContainer=$("#affwp-drm-modal .jconfirm-content"),$messageContainer=$modalContainer.find("#affwp-drm-ajax-messages");$messageContainer.length||($messageContainer=$('<div id="affwp-drm-ajax-messages"></div>'),$modalContainer.find("form").after($messageContainer)),$messageContainer.attr("data-type","success"===type?"success":"error").html(message)};$(document).on("submit","#affwp-drm-ajax-license-activation",function(event){event.preventDefault(),event.stopPropagation();var $form=$(this),$submitBtn=$form.find("button"),buttonText=affiliatewp_education.drm.ajax.buttonText;$.ajax({type:"POST",url:affiliatewp_education.ajax_url,data:{nonce:affiliatewp_education.nonce,action:"affiliatewp_handle_license_form_submission",license_key:$form.find('input[name="license_key"]').val()},beforeSend:function(){$submitBtn.attr("disabled",!0).html(AffiliateWPEducation.core.getSpinner()+buttonText)},success:function(response){var _response$data,_response$data2;if(!response.success)return void showMessage(affiliatewp_education.drm.ajax.error);var licenseStatus=null===response||void 0===response||null===(_response$data=response.data)||void 0===_response$data||null===(_response$data=_response$data.license_data)||void 0===_response$data?void 0:_response$data.license;switch(licenseStatus){case"valid":showMessage(affiliatewp_education.drm.ajax.success,"success"),setTimeout(function(){location.reload()},3e3);break;case"expired":showMessage(affiliatewp_education.drm.ajax.expired);break;case"invalid":showMessage(affiliatewp_education.drm.ajax.invalid);break;default:if("license-http-failure"===(null===response||void 0===response||null===(_response$data2=response.data)||void 0===_response$data2?void 0:_response$data2.affwp_notice))return console.log(affiliatewp_education.drm.ajax.licenseHttpFailure.message),showMessage(affiliatewp_education.drm.ajax.licenseHttpFailure.message),void(buttonText=affiliatewp_education.drm.ajax.licenseHttpFailure.buttonText);showMessage(affiliatewp_education.drm.ajax.onError)}},error:function(){showMessage(affiliatewp_education.drm.ajax.onError)},complete:function(){$submitBtn.removeAttr("disabled").html(buttonText)}})})}};return app}(document,window,jQuery),AffiliateWPEducation.drm.init();