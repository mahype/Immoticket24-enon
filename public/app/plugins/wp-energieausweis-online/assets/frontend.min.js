jQuery(document).ready(function(a){function b(b){var c=a(".wpenon-nav-tabs > .active");if(c.length>0){var d=a(".wpenon-tab-pane.active"),e=!1,f=b;"next"==b?c.next().length>0?(f=c.next().find("a").attr("href"),e=!0):f="":"previous"==b&&(c.prev().length>0?(f=c.prev().find("a").attr("href"),e=!0):f=""),""!==f&&a(f).length>0&&(c.removeClass("active"),d.removeClass("active"),c=a('a[href="'+f+'"]').parent("li"),d=a(f),c.addClass("active"),d.addClass("active"),e&&a("html, body").animate({scrollTop:a("#wpenon-generate-form").offset().top-_wpenon_data.dynamic_functions.get_scroll_offset()-40},"slow")),a(document).trigger("wpenon.update_active_tab",[d.index()]),d.prev().length>0?a("#wpenon-previous-button").show():a("#wpenon-previous-button").hide(),d.next().length>0?a("#wpenon-next-button").show():a("#wpenon-next-button").hide()}}a("body").prepend('<div id="wpenon-preloader-overlay" class="wpenon-preloader-overlay"><div class="wpenon-preloader"></div></div>'),a("body").on("wpenon_ajax_start",function(){a("#wpenon-preloader-overlay").show()}),a("body").on("wpenon_ajax_end",function(){a("#wpenon-preloader-overlay").hide()}),a(".field-info .label").tooltip(),a("#wpenon-edit-submit").length>0&&a("#wpenon-edit-submit").on("click",function(){var b=a(".wpenon-tab-pane.active").attr("id");a("#wpenon_active_tab").val(b)}),b(""),a(".wpenon-form-link").on("click",function(c){var d=a(this).attr("href");if(a(d).length>0){b("#"+a(d).parents(".wpenon-tab-pane").attr("id")),a("html, body").animate({scrollTop:a(d).offset().top-_wpenon_data.dynamic_functions.get_scroll_offset()-40},"slow")}c.preventDefault()}),a("#wpenon-previous-button").on("click",function(a){b("previous"),a.preventDefault()}),a("#wpenon-next-button").on("click",function(a){b("next"),a.preventDefault()}),a(".wpenon-nav-tabs a").on("click",function(b){var c=a(this).attr("href"),d=a(c);a(document).trigger("wpenon.update_active_tab",[d.index()]),d.prev().length>0?a("#wpenon-previous-button").show():a("#wpenon-previous-button").hide(),d.next().length>0?a("#wpenon-next-button").show():a("#wpenon-next-button").hide()}),a("#wpenon-double-checked-entries").length&&(a(".edd-add-to-cart").addClass("disabled"),a(".edd_go_to_checkout").addClass("disabled"),a("#wpenon-double-checked-entries").on("click",function(b){a(this).prop("checked")?(a(".edd-add-to-cart").removeClass("disabled"),a(".edd_go_to_checkout").removeClass("disabled")):(a(".edd-add-to-cart").addClass("disabled"),a(".edd_go_to_checkout").addClass("disabled"))}),a(".edd-add-to-cart").on("click",function(b){a(this).hasClass("disabled")&&b.preventDefault()}),a(".edd_go_to_checkout").on("click",function(b){a(this).hasClass("disabled")&&b.preventDefault()})),a("#wpenon-thumbnail-form").on("submit",function(b){b.preventDefault();var c=this;if(c.submitter=document.activeElement.name,c.upload="wpenon_thumbnail_upload"==c.submitter,c.removeUpload="wpenon_thumbnail_delete"==c.submitter,c.energieausweis_id=_wpenon_data.energieausweis_id,c.parentElem=document.querySelector("#wpenon-thumbnail-form"),c.imageWrapper=document.querySelector(".thumbnail-wrapper"),c.imageButtons=c.parentElem.querySelector(".image-buttons"),c.delBtn=c.imageButtons.querySelector(".btn-danger"),c.percentSpan=c.imageButtons.querySelector("small"),!c.removeUpload||confirm("Soll das Bild wirklich gelöscht werden?")){c.upload&&c.delBtn&&c.imageButtons.removeChild(c.delBtn),c.formData=new FormData(this),c.formData.append("wpenon_thumbnail_upload",c.upload),c.formData.append("wpenon_thumbnail_delete",c.removeUpload),c.formData.append("energieausweis_id",c.energieausweis_id),c.updatePreview=function(a,b){var c=this;if(b){var d=a.tmpImage;if(d){c.imageWrapper.innerHTML="";var e=document.createElement("img");e.setAttribute("src",d.path),c.imageWrapper.appendChild(e);var f=document.createElement("button");f.setAttribute("type","submit"),f.setAttribute("name","wpenon_thumbnail_delete"),f.setAttribute("class","btn btn-danger btn-xs"),f.innerHTML="Bild löschen";var g=c.imageButtons.querySelector("small");c.imageButtons.removeChild(g),c.imageButtons.appendChild(f)}}},c.deleteAttachment=function(a,b){var c=this;if(b){c.imageWrapper.innerHTML="";c.querySelector("input[name='wpenon_thumbnail_file']").value="";var d=document.createElement("span");d.classList.add("glyphicon"),d.classList.add("glyphicon-picture"),c.imageWrapper.appendChild(d);var e=c.querySelector(".btn-danger");c.imageButtons.removeChild(e)}},c.errorMsg=function(a){var b=document.createElement("div");b.innerHTML="Fehler beim Upload "+a,b.classList.add("error"),c.parentElem.appendChild(b)};var d=new XMLHttpRequest;d.open("POST",this.action,!0),d.onload=function(){if(200===d.status){var b=JSON.parse(d.responseText);b.error||(c.updatePreview(b,c.upload),c.deleteAttachment(b,c.removeUpload)),a("body").trigger("wpenon_ajax_end")}else c.errorMsg(d.responseText)},"wpenon_thumbnail_upload"===c.submitter&&(c.imageButtons.appendChild(document.createElement("small")),c.percentSpan=c.imageButtons.querySelector("small"),d.upload.onprogress=function(a){Math.floor(100*a.loaded/a.total);c.percentSpan.innerHTML="<br />Verarbeite Bilddaten ..."}),a("body").trigger("wpenon_ajax_start"),d.send(c.formData)}}),a("#wpenon_thumbnail_file").on("change",function(){a("#imageUploadForm").submit()})});